{"ast":null,"code":"\"use strict\";\n\nvar _ = require(\"./lodash\");\n\nvar addLabel = require(\"./label/add-label\");\n\nvar util = require(\"./util\");\n\nvar d3 = require(\"./d3\");\n\nmodule.exports = createNodes;\n\nfunction createNodes(selection, g, shapes) {\n  var simpleNodes = g.nodes().filter(function (v) {\n    return !util.isSubgraph(g, v);\n  });\n  var svgNodes = selection.selectAll(\"g.node\").data(simpleNodes, function (v) {\n    return v;\n  }).classed(\"update\", true);\n  svgNodes.exit().remove();\n  svgNodes.enter().append(\"g\").attr(\"class\", \"node\").style(\"opacity\", 0);\n  svgNodes = selection.selectAll(\"g.node\");\n  svgNodes.each(function (v) {\n    var node = g.node(v);\n    var thisGroup = d3.select(this);\n    util.applyClass(thisGroup, node[\"class\"], (thisGroup.classed(\"update\") ? \"update \" : \"\") + \"node\");\n    thisGroup.select(\"g.label\").remove();\n    var labelGroup = thisGroup.append(\"g\").attr(\"class\", \"label\");\n    var labelDom = addLabel(labelGroup, node);\n    var shape = shapes[node.shape];\n\n    var bbox = _.pick(labelDom.node().getBBox(), \"width\", \"height\");\n\n    node.elem = this;\n\n    if (node.id) {\n      thisGroup.attr(\"id\", node.id);\n    }\n\n    if (node.labelId) {\n      labelGroup.attr(\"id\", node.labelId);\n    }\n\n    if (_.has(node, \"width\")) {\n      bbox.width = node.width;\n    }\n\n    if (_.has(node, \"height\")) {\n      bbox.height = node.height;\n    }\n\n    bbox.width += node.paddingLeft + node.paddingRight;\n    bbox.height += node.paddingTop + node.paddingBottom;\n    labelGroup.attr(\"transform\", \"translate(\" + (node.paddingLeft - node.paddingRight) / 2 + \",\" + (node.paddingTop - node.paddingBottom) / 2 + \")\");\n    var root = d3.select(this);\n    root.select(\".label-container\").remove();\n    var shapeSvg = shape(root, bbox, node).classed(\"label-container\", true);\n    util.applyStyle(shapeSvg, node.style);\n    var shapeBBox = shapeSvg.node().getBBox();\n    node.width = shapeBBox.width;\n    node.height = shapeBBox.height;\n  });\n  var exitSelection;\n\n  if (svgNodes.exit) {\n    exitSelection = svgNodes.exit();\n  } else {\n    exitSelection = svgNodes.selectAll(null); // empty selection\n  }\n\n  util.applyTransition(exitSelection, g).style(\"opacity\", 0).remove();\n  return svgNodes;\n}","map":{"version":3,"sources":["/home/raj/go/src/github.com/litmuschaos/litmus/litmus-portal/frontend/node_modules/dagre-d3/lib/create-nodes.js"],"names":["_","require","addLabel","util","d3","module","exports","createNodes","selection","g","shapes","simpleNodes","nodes","filter","v","isSubgraph","svgNodes","selectAll","data","classed","exit","remove","enter","append","attr","style","each","node","thisGroup","select","applyClass","labelGroup","labelDom","shape","bbox","pick","getBBox","elem","id","labelId","has","width","height","paddingLeft","paddingRight","paddingTop","paddingBottom","root","shapeSvg","applyStyle","shapeBBox","exitSelection","applyTransition"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _ = require(\"./lodash\");\nvar addLabel = require(\"./label/add-label\");\nvar util = require(\"./util\");\nvar d3 = require(\"./d3\");\n\nmodule.exports = createNodes;\n\nfunction createNodes(selection, g, shapes) {\n  var simpleNodes = g.nodes().filter(function(v) { return !util.isSubgraph(g, v); });\n  var svgNodes = selection.selectAll(\"g.node\")\n    .data(simpleNodes, function(v) { return v; })\n    .classed(\"update\", true);\n\n  svgNodes.exit().remove();\n\n  svgNodes.enter().append(\"g\")\n    .attr(\"class\", \"node\")\n    .style(\"opacity\", 0);\n\n  svgNodes = selection.selectAll(\"g.node\"); \n\n  svgNodes.each(function(v) {\n    var node = g.node(v);\n    var thisGroup = d3.select(this);\n    util.applyClass(thisGroup, node[\"class\"],\n      (thisGroup.classed(\"update\") ? \"update \" : \"\") + \"node\");\n\n    thisGroup.select(\"g.label\").remove();\n    var labelGroup = thisGroup.append(\"g\").attr(\"class\", \"label\");\n    var labelDom = addLabel(labelGroup, node);\n    var shape = shapes[node.shape];\n    var bbox = _.pick(labelDom.node().getBBox(), \"width\", \"height\");\n\n    node.elem = this;\n\n    if (node.id) { thisGroup.attr(\"id\", node.id); }\n    if (node.labelId) { labelGroup.attr(\"id\", node.labelId); }\n\n    if (_.has(node, \"width\")) { bbox.width = node.width; }\n    if (_.has(node, \"height\")) { bbox.height = node.height; }\n\n    bbox.width += node.paddingLeft + node.paddingRight;\n    bbox.height += node.paddingTop + node.paddingBottom;\n    labelGroup.attr(\"transform\", \"translate(\" +\n      ((node.paddingLeft - node.paddingRight) / 2) + \",\" +\n      ((node.paddingTop - node.paddingBottom) / 2) + \")\");\n\n    var root = d3.select(this);\n    root.select(\".label-container\").remove();\n    var shapeSvg = shape(root, bbox, node).classed(\"label-container\", true);\n    util.applyStyle(shapeSvg, node.style);\n\n    var shapeBBox = shapeSvg.node().getBBox();\n    node.width = shapeBBox.width;\n    node.height = shapeBBox.height;\n  });\n\n  var exitSelection;\n\n  if (svgNodes.exit) {\n    exitSelection = svgNodes.exit();\n  } else {\n    exitSelection = svgNodes.selectAll(null); // empty selection\n  }\n\n  util.applyTransition(exitSelection, g)\n    .style(\"opacity\", 0)\n    .remove();\n\n  return svgNodes;\n}\n"]},"metadata":{},"sourceType":"script"}