{"ast":null,"code":"var util = require(\"./util\");\n\nvar d3 = require(\"./d3\");\n\nvar addLabel = require(\"./label/add-label\");\n\nmodule.exports = createClusters;\n\nfunction createClusters(selection, g) {\n  var clusters = g.nodes().filter(function (v) {\n    return util.isSubgraph(g, v);\n  });\n  var svgClusters = selection.selectAll(\"g.cluster\").data(clusters, function (v) {\n    return v;\n  });\n  svgClusters.selectAll(\"*\").remove();\n  svgClusters.enter().append(\"g\").attr(\"class\", \"cluster\").attr(\"id\", function (v) {\n    var node = g.node(v);\n    return node.id;\n  }).style(\"opacity\", 0);\n  svgClusters = selection.selectAll(\"g.cluster\");\n  util.applyTransition(svgClusters, g).style(\"opacity\", 1);\n  svgClusters.each(function (v) {\n    var node = g.node(v);\n    var thisGroup = d3.select(this);\n    d3.select(this).append(\"rect\");\n    var labelGroup = thisGroup.append(\"g\").attr(\"class\", \"label\");\n    addLabel(labelGroup, node, node.clusterLabelPos);\n  });\n  svgClusters.selectAll(\"rect\").each(function (c) {\n    var node = g.node(c);\n    var domCluster = d3.select(this);\n    util.applyStyle(domCluster, node.style);\n  });\n  var exitSelection;\n\n  if (svgClusters.exit) {\n    exitSelection = svgClusters.exit();\n  } else {\n    exitSelection = svgClusters.selectAll(null); // empty selection\n  }\n\n  util.applyTransition(exitSelection, g).style(\"opacity\", 0).remove();\n  return svgClusters;\n}","map":{"version":3,"sources":["/home/raj/go/src/github.com/litmuschaos/litmus/litmus-portal/frontend/node_modules/dagre-d3/lib/create-clusters.js"],"names":["util","require","d3","addLabel","module","exports","createClusters","selection","g","clusters","nodes","filter","v","isSubgraph","svgClusters","selectAll","data","remove","enter","append","attr","node","id","style","applyTransition","each","thisGroup","select","labelGroup","clusterLabelPos","c","domCluster","applyStyle","exitSelection","exit"],"mappings":"AAAA,IAAIA,IAAI,GAAGC,OAAO,CAAC,QAAD,CAAlB;;AACA,IAAIC,EAAE,GAAGD,OAAO,CAAC,MAAD,CAAhB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,mBAAD,CAAtB;;AAEAG,MAAM,CAACC,OAAP,GAAiBC,cAAjB;;AAEA,SAASA,cAAT,CAAwBC,SAAxB,EAAmCC,CAAnC,EAAsC;AACpC,MAAIC,QAAQ,GAAGD,CAAC,CAACE,KAAF,GAAUC,MAAV,CAAiB,UAASC,CAAT,EAAY;AAAE,WAAOZ,IAAI,CAACa,UAAL,CAAgBL,CAAhB,EAAmBI,CAAnB,CAAP;AAA+B,GAA9D,CAAf;AACA,MAAIE,WAAW,GAAGP,SAAS,CAACQ,SAAV,CAAoB,WAApB,EACfC,IADe,CACVP,QADU,EACA,UAASG,CAAT,EAAY;AAAE,WAAOA,CAAP;AAAW,GADzB,CAAlB;AAGAE,EAAAA,WAAW,CAACC,SAAZ,CAAsB,GAAtB,EAA2BE,MAA3B;AACAH,EAAAA,WAAW,CAACI,KAAZ,GAAoBC,MAApB,CAA2B,GAA3B,EACGC,IADH,CACQ,OADR,EACiB,SADjB,EAEGA,IAFH,CAEQ,IAFR,EAEa,UAASR,CAAT,EAAW;AACpB,QAAIS,IAAI,GAAGb,CAAC,CAACa,IAAF,CAAOT,CAAP,CAAX;AACA,WAAOS,IAAI,CAACC,EAAZ;AACD,GALH,EAMGC,KANH,CAMS,SANT,EAMoB,CANpB;AAQAT,EAAAA,WAAW,GAAGP,SAAS,CAACQ,SAAV,CAAoB,WAApB,CAAd;AAEAf,EAAAA,IAAI,CAACwB,eAAL,CAAqBV,WAArB,EAAkCN,CAAlC,EACGe,KADH,CACS,SADT,EACoB,CADpB;AAGAT,EAAAA,WAAW,CAACW,IAAZ,CAAiB,UAASb,CAAT,EAAY;AAC3B,QAAIS,IAAI,GAAGb,CAAC,CAACa,IAAF,CAAOT,CAAP,CAAX;AACA,QAAIc,SAAS,GAAGxB,EAAE,CAACyB,MAAH,CAAU,IAAV,CAAhB;AACAzB,IAAAA,EAAE,CAACyB,MAAH,CAAU,IAAV,EAAgBR,MAAhB,CAAuB,MAAvB;AACA,QAAIS,UAAU,GAAGF,SAAS,CAACP,MAAV,CAAiB,GAAjB,EAAsBC,IAAtB,CAA2B,OAA3B,EAAoC,OAApC,CAAjB;AACAjB,IAAAA,QAAQ,CAACyB,UAAD,EAAaP,IAAb,EAAmBA,IAAI,CAACQ,eAAxB,CAAR;AACD,GAND;AAQAf,EAAAA,WAAW,CAACC,SAAZ,CAAsB,MAAtB,EAA8BU,IAA9B,CAAmC,UAASK,CAAT,EAAY;AAC7C,QAAIT,IAAI,GAAGb,CAAC,CAACa,IAAF,CAAOS,CAAP,CAAX;AACA,QAAIC,UAAU,GAAG7B,EAAE,CAACyB,MAAH,CAAU,IAAV,CAAjB;AACA3B,IAAAA,IAAI,CAACgC,UAAL,CAAgBD,UAAhB,EAA4BV,IAAI,CAACE,KAAjC;AACD,GAJD;AAMA,MAAIU,aAAJ;;AAEA,MAAInB,WAAW,CAACoB,IAAhB,EAAsB;AACpBD,IAAAA,aAAa,GAAGnB,WAAW,CAACoB,IAAZ,EAAhB;AACD,GAFD,MAEO;AACLD,IAAAA,aAAa,GAAGnB,WAAW,CAACC,SAAZ,CAAsB,IAAtB,CAAhB,CADK,CACwC;AAC9C;;AAEDf,EAAAA,IAAI,CAACwB,eAAL,CAAqBS,aAArB,EAAoCzB,CAApC,EACGe,KADH,CACS,SADT,EACoB,CADpB,EAEGN,MAFH;AAIA,SAAOH,WAAP;AACD","sourcesContent":["var util = require(\"./util\");\nvar d3 = require(\"./d3\");\nvar addLabel = require(\"./label/add-label\");\n\nmodule.exports = createClusters;\n\nfunction createClusters(selection, g) {\n  var clusters = g.nodes().filter(function(v) { return util.isSubgraph(g, v); });\n  var svgClusters = selection.selectAll(\"g.cluster\")\n    .data(clusters, function(v) { return v; });\n\n  svgClusters.selectAll(\"*\").remove();\n  svgClusters.enter().append(\"g\")\n    .attr(\"class\", \"cluster\")\n    .attr(\"id\",function(v){\n      var node = g.node(v);\n      return node.id;\n    })\n    .style(\"opacity\", 0);\n  \n  svgClusters = selection.selectAll(\"g.cluster\");\n\n  util.applyTransition(svgClusters, g)\n    .style(\"opacity\", 1);\n\n  svgClusters.each(function(v) {\n    var node = g.node(v);\n    var thisGroup = d3.select(this);\n    d3.select(this).append(\"rect\");\n    var labelGroup = thisGroup.append(\"g\").attr(\"class\", \"label\");\n    addLabel(labelGroup, node, node.clusterLabelPos);\n  });\n\n  svgClusters.selectAll(\"rect\").each(function(c) {\n    var node = g.node(c);\n    var domCluster = d3.select(this);\n    util.applyStyle(domCluster, node.style);\n  });\n\n  var exitSelection;\n\n  if (svgClusters.exit) {\n    exitSelection = svgClusters.exit();\n  } else {\n    exitSelection = svgClusters.selectAll(null); // empty selection\n  }\n\n  util.applyTransition(exitSelection, g)\n    .style(\"opacity\", 0)\n    .remove();\n\n  return svgClusters;\n}\n"]},"metadata":{},"sourceType":"script"}