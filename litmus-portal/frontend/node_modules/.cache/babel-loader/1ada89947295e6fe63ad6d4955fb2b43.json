{"ast":null,"code":"/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar createHeatmap2D = require('gl-heatmap2d');\n\nvar Axes = require('../../plots/cartesian/axes');\n\nvar str2RGBArray = require('../../lib/str2rgbarray');\n\nfunction Heatmap(scene, uid) {\n  this.scene = scene;\n  this.uid = uid;\n  this.type = 'heatmapgl';\n  this.name = '';\n  this.hoverinfo = 'all';\n  this.xData = [];\n  this.yData = [];\n  this.zData = [];\n  this.textLabels = [];\n  this.idToIndex = [];\n  this.bounds = [0, 0, 0, 0];\n  this.options = {\n    z: [],\n    x: [],\n    y: [],\n    shape: [0, 0],\n    colorLevels: [0],\n    colorValues: [0, 0, 0, 1]\n  };\n  this.heatmap = createHeatmap2D(scene.glplot, this.options);\n  this.heatmap._trace = this;\n}\n\nvar proto = Heatmap.prototype;\n\nproto.handlePick = function (pickResult) {\n  var options = this.options;\n  var shape = options.shape;\n  var index = pickResult.pointId;\n  var xIndex = index % shape[0];\n  var yIndex = Math.floor(index / shape[0]);\n  var zIndex = index;\n  return {\n    trace: this,\n    dataCoord: pickResult.dataCoord,\n    traceCoord: [options.x[xIndex], options.y[yIndex], options.z[zIndex]],\n    textLabel: this.textLabels[index],\n    name: this.name,\n    pointIndex: [yIndex, xIndex],\n    hoverinfo: this.hoverinfo\n  };\n};\n\nproto.update = function (fullTrace, calcTrace) {\n  var calcPt = calcTrace[0];\n  this.index = fullTrace.index;\n  this.name = fullTrace.name;\n  this.hoverinfo = fullTrace.hoverinfo; // convert z from 2D -> 1D\n\n  var z = calcPt.z;\n  this.options.z = [].concat.apply([], z);\n  var rowLen = z[0].length;\n  var colLen = z.length;\n  this.options.shape = [rowLen, colLen];\n  this.options.x = calcPt.x;\n  this.options.y = calcPt.y;\n  var colorOptions = convertColorscale(fullTrace);\n  this.options.colorLevels = colorOptions.colorLevels;\n  this.options.colorValues = colorOptions.colorValues; // convert text from 2D -> 1D\n\n  this.textLabels = [].concat.apply([], fullTrace.text);\n  this.heatmap.update(this.options);\n  var xa = this.scene.xaxis;\n  var ya = this.scene.yaxis;\n  fullTrace._extremes[xa._id] = Axes.findExtremes(xa, calcPt.x);\n  fullTrace._extremes[ya._id] = Axes.findExtremes(ya, calcPt.y);\n};\n\nproto.dispose = function () {\n  this.heatmap.dispose();\n};\n\nfunction convertColorscale(fullTrace) {\n  var scl = fullTrace.colorscale;\n  var zmin = fullTrace.zmin;\n  var zmax = fullTrace.zmax;\n  var N = scl.length;\n  var domain = new Array(N);\n  var range = new Array(4 * N);\n\n  for (var i = 0; i < N; i++) {\n    var si = scl[i];\n    var color = str2RGBArray(si[1]);\n    domain[i] = zmin + si[0] * (zmax - zmin);\n\n    for (var j = 0; j < 4; j++) {\n      range[4 * i + j] = color[j];\n    }\n  }\n\n  return {\n    colorLevels: domain,\n    colorValues: range\n  };\n}\n\nfunction createHeatmap(scene, fullTrace, calcTrace) {\n  var plot = new Heatmap(scene, fullTrace.uid);\n  plot.update(fullTrace, calcTrace);\n  return plot;\n}\n\nmodule.exports = createHeatmap;","map":{"version":3,"sources":["/home/raj/go/src/github.com/litmuschaos/litmus/litmus-portal/frontend/node_modules/plotly.js/src/traces/heatmapgl/convert.js"],"names":["createHeatmap2D","require","Axes","str2RGBArray","Heatmap","scene","uid","type","name","hoverinfo","xData","yData","zData","textLabels","idToIndex","bounds","options","z","x","y","shape","colorLevels","colorValues","heatmap","glplot","_trace","proto","prototype","handlePick","pickResult","index","pointId","xIndex","yIndex","Math","floor","zIndex","trace","dataCoord","traceCoord","textLabel","pointIndex","update","fullTrace","calcTrace","calcPt","concat","apply","rowLen","length","colLen","colorOptions","convertColorscale","text","xa","xaxis","ya","yaxis","_extremes","_id","findExtremes","dispose","scl","colorscale","zmin","zmax","N","domain","Array","range","i","si","color","j","createHeatmap","plot","module","exports"],"mappings":"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","sourcesContent":["/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n\n'use strict';\n\nvar createHeatmap2D = require('gl-heatmap2d');\nvar Axes = require('../../plots/cartesian/axes');\nvar str2RGBArray = require('../../lib/str2rgbarray');\n\n\nfunction Heatmap(scene, uid) {\n    this.scene = scene;\n    this.uid = uid;\n    this.type = 'heatmapgl';\n\n    this.name = '';\n    this.hoverinfo = 'all';\n\n    this.xData = [];\n    this.yData = [];\n    this.zData = [];\n    this.textLabels = [];\n\n    this.idToIndex = [];\n    this.bounds = [0, 0, 0, 0];\n\n    this.options = {\n        z: [],\n        x: [],\n        y: [],\n        shape: [0, 0],\n        colorLevels: [0],\n        colorValues: [0, 0, 0, 1]\n    };\n\n    this.heatmap = createHeatmap2D(scene.glplot, this.options);\n    this.heatmap._trace = this;\n}\n\nvar proto = Heatmap.prototype;\n\nproto.handlePick = function(pickResult) {\n    var options = this.options;\n    var shape = options.shape;\n    var index = pickResult.pointId;\n    var xIndex = index % shape[0];\n    var yIndex = Math.floor(index / shape[0]);\n    var zIndex = index;\n\n    return {\n        trace: this,\n        dataCoord: pickResult.dataCoord,\n        traceCoord: [\n            options.x[xIndex],\n            options.y[yIndex],\n            options.z[zIndex]\n        ],\n        textLabel: this.textLabels[index],\n        name: this.name,\n        pointIndex: [yIndex, xIndex],\n        hoverinfo: this.hoverinfo\n    };\n};\n\nproto.update = function(fullTrace, calcTrace) {\n    var calcPt = calcTrace[0];\n\n    this.index = fullTrace.index;\n    this.name = fullTrace.name;\n    this.hoverinfo = fullTrace.hoverinfo;\n\n    // convert z from 2D -> 1D\n    var z = calcPt.z;\n    this.options.z = [].concat.apply([], z);\n\n    var rowLen = z[0].length;\n    var colLen = z.length;\n    this.options.shape = [rowLen, colLen];\n\n    this.options.x = calcPt.x;\n    this.options.y = calcPt.y;\n\n    var colorOptions = convertColorscale(fullTrace);\n    this.options.colorLevels = colorOptions.colorLevels;\n    this.options.colorValues = colorOptions.colorValues;\n\n    // convert text from 2D -> 1D\n    this.textLabels = [].concat.apply([], fullTrace.text);\n\n    this.heatmap.update(this.options);\n\n    var xa = this.scene.xaxis;\n    var ya = this.scene.yaxis;\n    fullTrace._extremes[xa._id] = Axes.findExtremes(xa, calcPt.x);\n    fullTrace._extremes[ya._id] = Axes.findExtremes(ya, calcPt.y);\n};\n\nproto.dispose = function() {\n    this.heatmap.dispose();\n};\n\nfunction convertColorscale(fullTrace) {\n    var scl = fullTrace.colorscale;\n    var zmin = fullTrace.zmin;\n    var zmax = fullTrace.zmax;\n\n    var N = scl.length;\n    var domain = new Array(N);\n    var range = new Array(4 * N);\n\n    for(var i = 0; i < N; i++) {\n        var si = scl[i];\n        var color = str2RGBArray(si[1]);\n\n        domain[i] = zmin + si[0] * (zmax - zmin);\n\n        for(var j = 0; j < 4; j++) {\n            range[(4 * i) + j] = color[j];\n        }\n    }\n\n    return {\n        colorLevels: domain,\n        colorValues: range\n    };\n}\n\nfunction createHeatmap(scene, fullTrace, calcTrace) {\n    var plot = new Heatmap(scene, fullTrace.uid);\n    plot.update(fullTrace, calcTrace);\n    return plot;\n}\n\nmodule.exports = createHeatmap;\n"]},"metadata":{},"sourceType":"script"}